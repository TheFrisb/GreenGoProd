{% extends 'shop/base.html' %}
{% load static %}
{% block metatags %}
<meta property="og:image" content="https://promotivno.mk{% static 'icons/logo_meta_tag.webp' %}" />
{% endblock metatags %}
{% block content %}
<div class="content-container thank-you">
    <div class="thank-you-icon">
    <i class="fas fa-check-circle"></i>
    <h2 class="thank-you-heading">–ù–∞–ø—Ä–∞–≤–∏–≤—Ç–µ –≤–∏—Å—Ç–∏–Ω—Å–∫–∏ –∏–∑–±–æ—Ä.</h2>
    <p class="thank-you-message">–í–∏ –±–ª–∞–≥–æ–¥–∞—Ä–∏–º–µ –∑–∞ –Ω–∞—Ä–∞—á–∫–∞—Ç–∞ <span style="text-transform: capitalize;">{{ name }}</span> üòä</p>
    </div>
   
    <div class="order-info">
        <div class="order-info-item">
            <p class="order-info-title">–î–ê–¢–ê:</p>
            <p class="order-info-content">{{ order.created_at }}</p>
        </div>
        <div class="order-info-item">
            <p class="order-info-title">–í–ö–£–ü–ù–û:</p>
            <p class="order-info-content">{{ order.total_price }}</p>
        </div>
        <div class="order-info-item">
            <p class="order-info-title">–ü–õ–ê–å–ê–ä–ï:</p>
            <p class="order-info-content">–ü–ª–∞—ú–∞—ö–µ –ø—Ä–∏ –¥–æ—Å—Ç–∞–≤–∞ (+30 –¥–µ–Ω. –ø—Ä–æ–≤–∏–∑–∏—ò–∞)</p>
        </div>
    </div>
    {% if offerproduct %}
        <div class="thank-you-offer">
            {% csrf_token %}
            <input type="hidden" value="" name="offer_ordered_product_id" id="offer_ordered_product_id">
            <h5>—Å–ø–µ—Ü–∏—ò–∞–ª–Ω–∞ –ø–æ–Ω—É–¥–∞ —Å–∞–º–æ –¥–µ–Ω–µ—Å</h3>
            <h3 style="padding-top:6px">–ó–ê –í–¢–û–† –ö–£–ü–ï–ù –ü–†–û–ò–ó–í–û–î 20% –ü–û–ü–£–°–¢</h5>
            <div class="offer-box">
            <p class="offer-timer" style="font-weight: 600;">–ü–û–ù–£–î–ê–¢–ê –ò–°–¢–ï–ö–£–í–ê –ó–ê <br><span id="timer" style="font-size: 24px">03:00</span></p>
            <input type="hidden" class="order_id" value="{{ order.id }}">
            <input type="hidden" class="prod_id" value="{{ offerproduct.product.id }}">
            <picture>
                <source src="{{ offerproduct.product.thumbnail }}" type="image/webp">
                <img src="{{ offerproduct.product.thumbnail_as_jpeg.url }}" alt="" width="250" height="250">
            </picture>
            {% if offerproduct.attribute_name  %}
            <p class="offer-ttl">{{ offerproduct.product.title }} - {{offerproduct.attribute_name}}</p>
            <p class="rgl_price">{{ offerproduct.product.sale_price }} –¥–µ–Ω</p>
            <p class="sl_price">{{ offerproduct.attribute_price }} –¥–µ–Ω</p>
            <p class="offer-save">–î–û–ü–û–õ–ù–ò–¢–ï–õ–ù–ò 20% –ó–ê–®–¢–ï–î–ê</p>
            <div class="quantity product_data" style="margin-bottom:10px!important">
                <button class="decrement-btn offerbox">-</button>
                <input type="text" name="quantity" class="qty-input" value="1" aria-label="–ö–æ–ª–∏—á–∏–Ω–∞"> 
                <button class="increment-btn offerbox">+</button>
            </div>
            <button class="offer-button">–ù–ê–†–ê–ß–ê–à</button>
            {% else %}
            <p class="offer-ttl">{{ offerproduct.product.title }}</p>
            <p class="rgl_price">{{ offerproduct.product.sale_price }} –¥–µ–Ω</p>
            <p class="sl_price">{{ offerproduct.price }} –¥–µ–Ω</p>
            <p class="offer-save">–î–û–ü–û–õ–ù–ò–¢–ï–õ–ù–ò 20% –ó–ê–®–¢–ï–î–ê</p>
            <div class="quantity product_data" style="margin-bottom:10px!important">
                <button class="decrement-btn offerbox">-</button>
                <input type="text" name="quantity" class="qty-input" value="1" aria-label="–ö–æ–ª–∏—á–∏–Ω–∞"> 
                <button class="increment-btn offerbox">+</button>
            </div>
            <button class="offer-button">–ù–ê–†–ê–ß–ê–à</button>
            {% endif %}
            </div class="offer-box">
            <p class="notice">–ì–æ—Ä–µ–Ω–∞–≤–µ–¥–µ–Ω–∏–æ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥ –¥–æ–∫–æ–ª–∫—É –Ω–∞—Ä–∞—á–∞—Ç–µ —ú–µ –≤–∏ –±–∏–¥–µ –¥–æ—Å—Ç–∞–≤–µ–Ω —Å–æ –∏—Å—Ç–∞—Ç–∞ –Ω–∞—Ä–∞—á–∫–∞</p>
        </div>
    {% endif %}
    
    <p class="thank-you-info">–¢–í–û–à–ê–¢–ê –ù–ê–†–ê–ß–ö–ê</p>
    <div id="thank-you-order-review">
        <table class="order-review-table cart-data thank-you-table">
            <thead>
                <tr>
                    <td>–ü—Ä–æ–¥—É–∫—Ç</td>
                    <td>–¶–µ–Ω–∞</td>
            </thead>
            <tbody >
            {% for item in orderItems %}
            <tr class="cart-item-row">
                <td class="cart-item product_data" style="padding: 9px 12px;">
                    <input type="hidden" class="prod_id" value="{{ item.product_id }}">
                    {% csrf_token %}
                    {% if item.upsell_thumbnail %}
                        <img src="{{ item.upsell_thumbnail }}" alt="" width="45" height="45">
                    {% else %}
                    
                        <picture>
                            <source src="{{ item.product.thumbnail_loop.url }}" type="image/webp">
                            <img src="{{ item.product.thumbnail_loop_as_jpeg.url }}" alt="" width="45" height="45">
                        </picture>

                    {% endif %}
                    {% if item.attribute_name %}
                    <p class="item-name">{{ item.product.title }} - {{item.attribute_name}}</p>
                    {% else %}
                        {% if item.item_name %}
                            <p class="item-name">{{ item.item_name }}</p>
                        {% else %}
                            <p class="item-name">{{ item.product.title }}</p>
                        {% endif %}
                    {% endif %}
                    <strong class="product-quantity">x {{ item.quantity }}</strong>
                </td>
                
                    
                
                <td class="cart-item-total-row">
                    <p class="item-total">{{ item.price }} –¥–µ–Ω</p>

                </td>
            </tr>
            {% endfor %}
            </tbody>
            <tfoot>
                {% if orderFees %}
                        {% for fee in orderFees %}
                        <tr class="cart-fees"> 
                            <td>
                                <p>{{ fee.title }}</p>
                            </td>
                            <td>
                                <p>{{ fee.price }} –¥–µ–Ω</p>
                            </td>
                        </tr>
                        {% endfor %}
                    {% endif %}
                <tr class="cart-subtotal"> 
                    <td>
                        <p>–¶–µ–Ω–∞</p>
                    </td>
                    <td>
                        <p>{{order.subtotal_price}} –¥–µ–Ω</p>
                    </td>
                </tr>
                <tr class="cart-shipping">
                    <td>
                        <p>–î–æ—Å—Ç–∞–≤–∞</p>
                    </td>
                    <td>
                        {% if order.shipping == True %}
                        <p class="cart-shipping-method">–î–æ –≤—Ä–∞—Ç–∞ - 180–¥–µ–Ω</p>
                        {% else %}
                        <p class="cart-shipping-method">–ë–µ—Å–ø–ª–∞—Ç–Ω–∞ –¥–æ—Å—Ç–∞–≤–∞</p>
                        {% endif %}
                    </td>
                </tr>
                <tr class="cart-provision">
                    <td>
                        <p>–ü—Ä–æ–≤–∏–∑–∏—ò–∞ –∑–∞ –≥–æ—Ç–æ–≤–∏–Ω—Å–∫–æ —Ä–∞–±–æ—Ç–µ—ö–µ</p>
                    </td>
                    <td>
                        <p class="cart-provision-sum">30 –¥–µ–Ω</p>
                    </td>
                </tr>
                <tr class="cart-total">
                    <td>
                        <p>–í–∫—É–ø–Ω–æ</p>
                    </td>
                    <td>
                        <p>{{ order.total_price }} –¥–µ–Ω</p>
                    </td>
                </tr>
            </tfoot>
            
        </table>
    </div>




    <p class="thank-you-info">–û–°–¢–ê–í–ï–ù–ò –ü–û–î–ê–¢–û–¶–ò –ó–ê –î–û–°–¢–ê–í–ê</p>
    <p class="thank-you-message">{{ order.name }}</p>
    <p class="thank-you-message">{{ order.address }}</p>
    <p class="thank-you-message">{{ order.city }}</p>
    <p class="thank-you-message">{{ order.number }}</p>
    <p class="thank-you-message thankumessage-last">(–¥–æ–∫–æ–ª–∫—É —Å–∞–∫–∞—Ç–µ –¥–∞ —ò–∞ –∏–∑–º–µ–Ω–∏—Ç–µ –≤–∞—à–∞—Ç–∞ –Ω–∞—Ä–∞—á–∫–∞ –∏–ª–∏ —Å–∞–∫–∞—Ç–µ –¥–∞ –ø—Ä–æ–º–µ–Ω–∏—Ç–µ –Ω–µ–∫–æ–∏ –æ–¥ –≤–∞—à–∏—Ç–µ –ø–æ–¥–∞—Ç–æ—Ü–∏ –∑–∞ –¥–æ—Å—Ç–∞–≤–∞ –≤–µ –º–æ–ª–∏–º–µ –∫–æ–Ω—Ç–∞–∫—Ç–∏—Ä–∞—ò—Ç–µ –Ω–µ –Ω–∞ 071/321-314)</p>
    <a href="{% url 'shop-home' %}" class="thankyou-proceed-to-home">–ü–†–û–î–û–õ–ñ–ò –°–û –ö–£–ü–£–í–ê–ä–ï</a>
</div>
{% endblock content %}

{% block scripts %}
<script>
    var timerDisplay = document.getElementById("timer");
    var timerDuration = 180;
    var timerInterval = setInterval(updateTimer, 1000);
    function updateTimer() {
        var minutes = Math.floor(timerDuration / 60);
        var seconds = timerDuration % 60;
        var displayString = minutes.toString().padStart(2, '0') + ":" + seconds.toString().padStart(2, '0');
        timerDisplay.textContent = displayString;
        if (timerDuration <= 0) {
            clearInterval(timerInterval);
            timerDisplay.textContent = "00:00";
        }
        timerDuration--;
    }
</script>
{% endblock scripts %}
