function create_custom_dropdowns(){$("select").each(function(e,t){if(!$(this).next().hasClass("dropdown-select")){$(this).after('<div class="dropdown-select wide '+($(this).attr("class")||"")+'" tabindex="0"><span class="current"></span><div class="list"><ul></ul></div></div>');var s=$(this).next();window.matchMedia("(max-width: 767px)").matches&&$(s).addClass("ismobile");var n=$(t).find("option"),o=$(this).find("option:selected");s.find(".current").html(o.data("display-text")||o.text()),n.each(function(e,t){var n=$(t).data("display-text")||"";s.find("ul").append('<li class="option '+($(t).is(":selected")?"selected":"")+'" data-value="'+$(t).val()+'" data-display-text="'+n+'">'+$(t).text()+'<span style="display:none">'+$(t).attr("fake-name")+"</span></li>")})}}),$(".dropdown-select ul").before('<div class="dd-search"><input id="txtSearchValue" autocomplete="off" onkeyup="filter()" class="dd-searchbox" type="text"></div>')}function filter(){var e=$("#txtSearchValue").val();$(".dropdown-select ul > li").each(function(){$(this).text().toLowerCase().indexOf(e.toLowerCase())>-1?$(this).show():$(this).hide()})}$(document).on("click",".dropdown-select",function(e){$(this).removeClass("red"),!$(e.target).hasClass("dd-searchbox")&&($(".dropdown-select").not($(this)).removeClass("open"),$(this).toggleClass("open"),$(this).hasClass("open")?($(this).find(".option").attr("tabindex",0),$(this).find(".selected").focus(),$("#txtSearchValue").focus(),$(this).hasClass("ismobile")&&$("html, body").animate({scrollTop:$(this).offset().top-100},800)):($(this).find(".option").removeAttr("tabindex"),$(this).focus()))}),$(document).on("click",function(e){0===$(e.target).closest(".dropdown-select").length&&($(".dropdown-select").removeClass("open"),$(".dropdown-select .option").removeAttr("tabindex")),e.stopPropagation()}),$(document).on("click",".dropdown-select .option",function(e){input=$(".checkout-city"),$(this).closest(".list").find(".selected").removeClass("selected"),$(this).addClass("selected");var t=$(this).data("value");$(this).closest(".dropdown-select").find(".current").text(t),$(this).closest(".dropdown-select").prev("select").val($(this).data("value")).trigger("change"),$(input).val(t)}),$(document).on("keydown",".dropdown-select",function(e){var t=$($(this).find(".list .option:focus")[0]||$(this).find(".list .option.selected")[0]);if(13==e.keyCode)return $(this).hasClass("open")?t.trigger("click"):$(this).trigger("click"),!1;if(40==e.keyCode)return $(this).hasClass("open")?t.next().focus():$(this).trigger("click"),!1;if(38==e.keyCode){if($(this).hasClass("open")){var t=$($(this).find(".list .option:focus")[0]||$(this).find(".list .option.selected")[0]);t.prev().focus()}else $(this).trigger("click");return!1}if(27==e.keyCode)return $(this).hasClass("open")&&$(this).trigger("click"),!1}),$(document).ready(function(){create_custom_dropdowns(),$(document).on("click","#place_order",function(e){var t=$(".checkout-city").val();if("Undefined"===t||"Одбери град"===t){e.preventDefault(),$(".dropdown-select").addClass("red"),$("html, body").animate({scrollTop:$(".dropdown-select").offset().top-100},800);return}});var e=$("input[name=csrfmiddlewaretoken]").val();(function(e){e.fn.extend({donetyping:function(t,s){s=s||1e3;var n,o=function(e){n&&(n=null,t.call(e))};return this.each(function(t,i){var a=e(i);a.is(":input")&&a.on("keyup keypress paste",function(e){("keyup"!=e.type||8==e.keyCode)&&(n&&clearTimeout(n),n=setTimeout(function(){o(i)},s))}).on("blur",function(){o(i)})})}})})(jQuery),$("#checkout_input_name").donetyping(function(){input_name=$("#checkout_input_name").val(),input_phone=$("#checkout_input_phone").val(),input_address=$("#checkout_input_address").val(),$.ajax({method:"POST",url:"/check-abandoned-carts",data:{name:input_name,phone:input_phone,address:input_address,csrfmiddlewaretoken:e},success:function(e){}})},3e3),$("#checkout_input_phone").donetyping(function(){input_name=$("#checkout_input_name").val(),input_phone=$("#checkout_input_phone").val(),input_address=$("#checkout_input_address").val(),$.ajax({method:"POST",url:"/check-abandoned-carts",data:{name:input_name,phone:input_phone,address:input_address,csrfmiddlewaretoken:e},success:function(e){}})},3e3),$("#checkout_input_address").donetyping(function(){input_name=$("#checkout_input_name").val(),input_phone=$("#checkout_input_phone").val(),input_address=$("#checkout_input_address").val(),$.ajax({method:"POST",url:"/check-abandoned-carts",data:{name:input_name,phone:input_phone,address:input_address,csrfmiddlewaretoken:e},success:function(e){}})},3e3)});
